import{f as h,e as w,a as u,s as m}from"../chunks/TaKWw6Tr.js";import{i as ce}from"../chunks/j2M9h5Jk.js";import{o as ue}from"../chunks/r3_wVOpG.js";import{B as he,a7 as Ee,a8 as Ce,E as _,a,F as fe,G as l,s as g,a3 as U,I as r,H as n,u as o,z as Le,n as De,a9 as je,aa as ze}from"../chunks/WP6s4_OC.js";import{F as Be,h as Ie}from"../chunks/B87DtkF7.js";import{e as Ge,b as re,p as le,g as ne,a as He,c as Z,v as ie,u as Oe,r as oe,s as de,d as D,f as ve,i as Te,m as Ye,h as M,j as Ze,k as Me,l as Ve}from"../chunks/Diy1FCfe.js";import{i as x,s as Xe,a as qe}from"../chunks/DEPZNxei.js";var Je=h('<div class="detail-row svelte-d580bl"><span class="label svelte-d580bl">ID:</span> </div>'),Ne=h('<div class="detail-row svelte-d580bl"><span class="label svelte-d580bl">Version:</span> </div>'),Ke=h('<div class="detail-row svelte-d580bl"><span class="label svelte-d580bl">Author:</span> </div>'),Qe=h('<div class="detail-row svelte-d580bl"><span class="label svelte-d580bl">Description:</span> </div>'),We=h('<div class="plugin-details svelte-d580bl"><!> <!> <!> <!> <div class="detail-row svelte-d580bl"><span class="label svelte-d580bl">URL:</span> <a target="_blank" rel="noopener" class="url-link svelte-d580bl"> </a></div> <button class="remove-btn svelte-d580bl">Remove Plugin</button></div>'),ea=h('<li><div class="plugin-header svelte-d580bl"><div class="plugin-title-group svelte-d580bl"><div></div> <span class="plugin-name svelte-d580bl"> </span></div></div> <!></li>'),aa=h('<li class="empty svelte-d580bl">No plugins installed</li>'),sa=h(`<div class="settings-panel retro-theme svelte-d580bl"><section class="svelte-d580bl"><h3 class="svelte-d580bl">Plugins</h3> <p class="desc svelte-d580bl">Load external JavaScript plugins to enhance your game client. Plugins are loaded from the
			provided URL and have full access to the game environment.</p> <p class="desc svelte-d580bl">See the <a href="https://github.com/merklejerk/furnarchy-zero" target="_blank" rel="noopener">Github README</a> for information on developing plugins.</p> <div class="input-group svelte-d580bl"><input type="text" placeholder="https://example.com/my-plugin.js" class="svelte-d580bl"/> <button class="svelte-d580bl"> </button></div> <ul class="plugin-list svelte-d580bl"><!> <!></ul></section> <section class="svelte-d580bl"><h3 class="svelte-d580bl">Auth Proxy Server</h3> <p class="desc svelte-d580bl">A CORS-friendly proxy server that forwards login requests to the official Furacadia auth
			server (terra.furcadia.com). Be careful! Your password will be transmitted to this address.
			The default is the furnarchy auth proxy (terra.furnarchy.xyz), which is secure, open source,
			and does not log or store credentials. You can also plug in your own for peace of mind.</p> <p class="desc svelte-d580bl">Check the <a href="https://github.com/merklejerk/furnarchy-zero" target="_blank" rel="noopener">Github README</a> for why this is necessary.</p> <div class="input-group svelte-d580bl"><input type="text" class="svelte-d580bl"/> <button class="svelte-d580bl">Save</button></div></section></div>`);function ta(j,F){he(F,!1);const v=()=>qe(le,"$pluginStore",S),[S,$]=Xe(),y=U();let c=U(""),k=U(""),f=U(null),b=U(!1);ue(()=>{le.set(ne()),g(k,He()||Z.PUBLIC_AUTH_PROXY_URL),V()});async function V(){const s=ne();await Promise.all(s.map(async e=>{try{const t=await ie(e.url);Oe(e.url,{id:t.id,name:t.name,description:t.description,version:t.version,author:t.author})}catch(t){console.warn(`[SettingsPanel] Failed to refresh metadata for ${e.url}`,t)}}))}async function X(){if(a(c)){if(v().some(s=>s.url===a(c))){alert("Plugin already added!");return}g(b,!0);try{const s=await ie(a(c)),e=[...v(),{id:s.id,url:a(c),name:s.name,description:s.description,version:s.version,author:s.author,enabled:s.toggle!==void 0?!s.toggle:!0}];M(e),g(c,"")}catch(s){alert(`Failed to verify plugin: ${s.message||s}`)}finally{g(b,!1)}}}function be(s){const e=v().find(p=>p.url===s);e&&e.id&&Ye(e.id);const t=v().filter(p=>p.url!==s);M(t)}function pe(s){const e=v().map(t=>t.url===s?{...t,enabled:t.enabled===void 0?!1:!t.enabled}:t);M(e)}function ge(){Ze(a(k)),alert("Settings saved!")}Ee(()=>v(),()=>{g(y,[...v()].sort((s,e)=>{const t=s.enabled!==!1,p=e.enabled!==!1;return t!==p?t?-1:1:(s.name||s.url).localeCompare(e.name||e.url)}))}),Ce(),ce();var z=sa(),B=l(z),I=r(l(B),6),A=l(I);oe(A);var R=r(A,2),me=l(R,!0);n(R),n(I);var q=r(I,2),J=l(q);Ge(J,1,()=>a(y),Te,(s,e)=>{var t=ea();let p;var G=l(t),Q=l(G),C=l(Q);let W;var H=r(C,2),Pe=l(H,!0);n(H),n(Q),n(G);var we=r(G,2);{var xe=O=>{var L=We(),ee=l(L);{var Se=i=>{var d=Je(),P=r(l(d));n(d),_(()=>m(P,` ${a(e),o(()=>a(e).id)??""}`)),u(i,d)};x(ee,i=>{a(e),o(()=>a(e).id)&&i(Se)})}var ae=r(ee,2);{var $e=i=>{var d=Ne(),P=r(l(d));n(d),_(()=>m(P,` ${a(e),o(()=>a(e).version)??""}`)),u(i,d)};x(ae,i=>{a(e),o(()=>a(e).version)&&i($e)})}var se=r(ae,2);{var Ae=i=>{var d=Ke(),P=r(l(d));n(d),_(()=>m(P,` ${a(e),o(()=>a(e).author)??""}`)),u(i,d)};x(se,i=>{a(e),o(()=>a(e).author)&&i(Ae)})}var te=r(se,2);{var Ue=i=>{var d=Qe(),P=r(l(d));n(d),_(()=>m(P,` ${a(e),o(()=>a(e).description)??""}`)),u(i,d)};x(te,i=>{a(e),o(()=>a(e).description)&&i(Ue)})}var T=r(te,2),Y=r(l(T),2),Fe=l(Y,!0);n(Y),n(T);var Re=r(T,2);n(L),_(()=>{D(Y,"href",(a(e),o(()=>a(e).url))),m(Fe,(a(e),o(()=>a(e).url)))}),w("click",Re,()=>be(a(e).url)),w("click",L,ve(function(i){Me.call(this,F,i)})),u(O,L)};x(we,O=>{a(f),a(e),o(()=>a(f)===a(e).url)&&O(xe)})}n(t),_(()=>{p=de(t,1,"plugin-item svelte-d580bl",null,p,{expanded:a(f)===a(e).url,disabled:a(e).enabled===!1}),W=de(C,1,"toggle-switch svelte-d580bl",null,W,{checked:a(e).enabled!==!1}),D(C,"title",(a(e),o(()=>a(e).enabled!==!1?"Disable Plugin":"Enable Plugin"))),D(H,"title",(a(e),o(()=>a(e).url))),m(Pe,(a(e),o(()=>a(e).name||a(e).url)))}),w("click",C,ve(()=>pe(a(e).url))),w("click",t,()=>g(f,a(f)===a(e).url?null:a(e).url)),u(s,t)});var _e=r(J,2);{var ye=s=>{var e=aa();u(s,e)};x(_e,s=>{a(y),o(()=>a(y).length===0)&&s(ye)})}n(q),n(B);var N=r(B,2),K=r(l(N),6),E=l(K);oe(E);var ke=r(E,2);n(K),n(N),n(z),_(()=>{A.disabled=a(b),R.disabled=a(b),m(me,a(b)?"Verifying...":"Add"),D(E,"placeholder",(Le(Z),o(()=>Z.PUBLIC_AUTH_PROXY_URL)))}),re(A,()=>a(c),s=>g(c,s)),w("keydown",A,s=>s.key==="Enter"&&!a(b)&&X()),w("click",R,X),re(E,()=>a(k),s=>g(k,s)),w("click",ke,ge),u(j,z),fe(),$()}var ra=h(`<div class="landing-page retro-theme svelte-1uha8ag"><header class="svelte-1uha8ag"><img src="/logo.png" alt="Furnarchy Zero Logo" width="384"/> <p class="subtitle svelte-1uha8ag">A plugin-enabled web client for Furcadia.</p> <div class="version svelte-1uha8ag"> </div></header> <main><div class="actions svelte-1uha8ag"><a href="/play" class="play-btn svelte-1uha8ag" data-sveltekit-reload="">Launch Client</a></div> <div class="info-section svelte-1uha8ag"><h2 class="svelte-1uha8ag">About</h2> <p>Furnarchy Zero is a wrapper around the official Furcadia web client that enables client-side
				scripting and plugins. Brought to you by the author of Furnarchy 1, 3, and 2 (yes, counting
				is hard).</p> <p><strong>Disclaimer:</strong> This is an experimental third-party tool and is not affiliated with
				Dragon's Eye Productions. Use at your own risk. Plugins have full access to your game session.
				Only install plugins from trusted sources.</p></div> <div class="settings-section"><h2 class="svelte-1uha8ag">Configuration</h2> <!></div></main> <footer class="svelte-1uha8ag"><div class="footer-links svelte-1uha8ag"><a href="https://github.com/merklejerk/furnarchy-zero" target="_blank" rel="noopener noreferrer" class="svelte-1uha8ag">GitHub</a> <span class="separator svelte-1uha8ag">â€¢</span> <a href="https://github.com/merklejerk/furnarchy-zero/issues" target="_blank" rel="noopener noreferrer" class="svelte-1uha8ag">Report Issue</a></div> <p>Furnarchy Zero &copy; 2025</p></footer></div>`);function ua(j,F){he(F,!1);const v=new Be().version;ue(async()=>{await Ve(v)}),ce();var S=ra();Ie("1uha8ag",V=>{De(()=>{je.title="Furnarchy Zero"})});var $=l(S),y=r(l($),4),c=l(y);n(y),n($);var k=r($,2),f=r(l(k),4),b=r(l(f),2);ta(b,{}),n(f),n(k),ze(2),n(S),_(()=>m(c,`v${v??""}`)),u(j,S),fe()}export{ua as component};
